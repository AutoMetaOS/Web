var C=Object.defineProperty,S=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var p=(s,t,e)=>t in s?C(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,d=(s,t)=>{for(var e in t||(t={}))E.call(t,e)&&p(s,e,t[e]);if(g)for(var e of g(t))H.call(t,e)&&p(s,e,t[e]);return s},b=(s,t)=>S(s,B(t));import{$ as z,S as A,i as D,s as F,e as U,a0 as q,c as I,a as v,a1 as J,d as f,a2 as h,a3 as _,b as N,g as y,J as V,U as Z,a4 as $,z as G,l as m,E as w,C as K}from"./index-132e5a0e.js";import{w as O}from"./index-cfd1276c.js";import{s as P}from"./index-de878877.js";const Q=s=>fetch(`https://openlibrary.org${s}`).then(t=>t.json()),R=async s=>{let t="q=";return s.author&&(t=`author=${s.author}`),s.default&&(t=`q=${s.default}`),(await Q(`/search.json?${t}`)).docs},T={added:{style:[["background","#0f0a"]]},suggest:{"data-func":"add",style:[["background","#0aff"]]},error:{style:[["background","#f00a"]]},todo:{"data-func":"add",style:[["background","#0cc"]]}},W={error:[{tag:"path",attributes:[["d","M2 30 L30 2 M30 30 L2 2"]]}],added:[{tag:"path",attributes:[["d","M2 20 L12 28 30 4"]]}],suggest:[{tag:"path",attributes:[["d","M16 2 L16 30 M2 16 L30 16"]]}],todo:[{tag:"path",attributes:[["d","M2 20 L12 28 30 4"]]}]};var j={objective:T,icons:W};const X=O([]),Y=s=>s?s.filter(t=>!/[^a-zA-Z]/i.test(t)).map(t=>t.toLowerCase().trim()).slice(0,4).join(", "):[],x=s=>{if(!s)return"Unknown";if(typeof s=="string")return s;if(typeof s=="object"){const t=[...new Set(s.map(e=>e.trim()))];return t.length>3?`${t.slice(0,3).join(", ")} et al.`:t.join(", ")}},tt=s=>{if(s.length===0)return null;if(typeof s=="string")return+s;if(typeof s=="object")return+s[0]},L={basic:s=>{let t="default",e="";return s.split(":").length>1?[t,e]=s.split(":"):e=s,[e,t].map(a=>a.trim().toLowerCase()),{type:t,text:e}},search:s=>{const{type:t,text:e}=L.basic(s);return t==="author"?{author:e}:{default:e}}},et=s=>{let t="suggest";const e=s.cover_edition_key||s.bk_id||s.id;return z(X).includes(e)&&(t="added"),b(d({},s),{objective:t})},st=s=>{var a;const t=d({},j.objective[s]),e=(a=t.style)==null?void 0:a.map(o=>o.join(":")).join(";");return t.style=e,t},at=s=>{var e;const t=(e=j.icons[s])==null?void 0:e.map(a=>{var i;const o=a.tag,l=(i=a.attributes)==null?void 0:i.map(r=>`${r[0]}="${r[1]}"`).join(" ");return`<${o} ${l}/>`});return t==null?void 0:t.join(" ")},ut={search:R},u={author:x,tags:Y,published:tt,results:et,form:L,attributes:st,icons:at};function k(s){let t,e,a=u.icons(s[0])+"",o,l,i=[u.attributes(s[0]),{viewBox:"0 0 32 32"},{fill:"none"},{stroke:"#fff"}],r={};for(let n=0;n<i.length;n+=1)r=K(r,i[n]);return{c(){t=U("div"),e=q("svg"),this.h()},l(n){t=I(n,"DIV",{class:!0});var c=v(t);e=J(c,"svg",{viewBox:!0,fill:!0,stroke:!0});var M=v(e);M.forEach(f),c.forEach(f),this.h()},h(){h(e,r),_(e,"svelte-1wfwwk",!0),N(t,"class","funcs \u0192 hover \u2206-bw p10 p-abs svelte-1wfwwk")},m(n,c){y(n,t,c),V(t,e),e.innerHTML=a,o||(l=Z(t,"click",$(s[1])),o=!0)},p(n,c){c&1&&a!==(a=u.icons(n[0])+"")&&(e.innerHTML=a),h(e,r=G(i,[c&1&&u.attributes(n[0]),{viewBox:"0 0 32 32"},{fill:"none"},{stroke:"#fff"}])),_(e,"svelte-1wfwwk",!0)},d(n){n&&f(t),o=!1,l()}}}function nt(s){let t,e=s[0]&&k(s);return{c(){e&&e.c(),t=m()},l(a){e&&e.l(a),t=m()},m(a,o){e&&e.m(a,o),y(a,t,o)},p(a,[o]){a[0]?e?e.p(a,o):(e=k(a),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:w,o:w,d(a){e&&e.d(a),a&&f(t)}}}function ot(s,t,e){let{objective:a="sugg",data:o={title:"",image:"",tags:"",id:"",published:"",author:""}}=t;const l=r=>P.put("books",Date.now().toString(36),r).then(n=>{console.log(n),n.charAt(0)=='"'?e(0,a="added"):e(0,a="error")}),i=r=>{const{func:n}=r.target.dataset;n==="add"&&l(o)};return s.$$set=r=>{"objective"in r&&e(0,a=r.objective),"data"in r&&e(2,o=r.data)},[a,i,o]}class ft extends A{constructor(t){super(),D(this,t,ot,nt,F,{objective:0,data:2})}}export{ft as F,ut as a,X as b,u as p};
